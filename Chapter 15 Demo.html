<!DOCTYPE html>
<html lang="en">
<head>
 <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width">
  <title>Chapter 15 Demo</title>


 <!-- Including Math -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/9.4.3/math.js"></script>

  <!-- Including MathJax -->
  <script>
  MathJax = {
    tex: {inlineMath: [['$', '$'], ['\\(', '\\)']]}
  };
  </script>
  <script id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

 

  <!-- Including Plotly -->
  <script>
  window.PlotlyConfig = {MathJaxConfig: 'local'}
  </script>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

  <!-- Including D3 -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.0.0/d3.min.js"></script>

   <!-- Including JSXGraph -->
  <script type="text/javascript" charset="UTF-8"
 src="https://cdn.jsdelivr.net/npm/jsxgraph/distrib/jsxgraphcore.js"></script>
 <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/jsxgraph/distrib/jsxgraph.css" />


 <script src="js/auxiliary.js"> </script> 
 <script src="js/JSX_auxilliary_functions.js"> </script> 


  <style>

.range-wrap {
  position: relative;
  margin: 0 8% 2.3rem 0rem;
}
.range {
  width: 100%;
}
.bubble {
  background: dodgerblue;
  color: white;
  padding: 4px 12px;
  position: absolute;
  border-radius: 4px;
  left: 50%;
  transform: translateX(-50%);
}

.bubble::after {
  content: "";
  position: absolute;
  width: 2px;
  height: 2px;
  background: dodgerblue;
  top: -1px;
  left: 50%;
}


/* Create two unequal columns that floats next to each other */
.column {
  float: left;
}

.left {
 float: left;
 width: 33%;

}

.right {
  float: left;
  width: 60%;
  padding-left: 3%

}

/* Clear floats after the columns */
.row:after {
  content: "";
  display: table;
  clear: both;
}

Responsive layout - makes the two columns stack on top of each other instead of next to each other 
@media screen and (width: 620px) {
.left, .right {
  width: 100%;
}
}
</style>

<link rel="stylesheet" href="css/style.css">

</head>



<body id = "body">


<nav>
<a href="index_page.html">back to menu</a> | 
<a href="Chapter 14 Demo.html">previous Chapter</a> | 
<a href="Chapter 16 Demo.html">next Chapter</a>
</nav>


<p style="display: none">
$\newcommand{\R}{\mathbf{R}}
\newcommand{\C}{\mathbf{C}}
\newcommand{\A}{\mathcal{A}}
\newcommand{\cF}{\mathcal{F}}
\newcommand{\SPAN}{\text{span}}
\newcommand{\B}{\mathcal{B}}
\newcommand{\calL}{\mathcal{L}}
\renewcommand{\u}{\mathbf{u}}
\newcommand{\uu}{\mathbf{u}}
\newcommand{\e}{\mathbf{e}}
\newcommand{\vv}{\mathbf{v}}
\newcommand{\w}{\mathbf{w}}
\newcommand{\ww}{\mathbf{w}}
\newcommand{\x}{\mathbf{x}}
\newcommand{\xx}{\mathbf{x}}
\newcommand{\y}{\mathbf{y}}
\newcommand{\yy}{\mathbf{y}}
\newcommand{\Cbar}{\overline{\mathbf{C}}}
\newcommand{\Dbar}{\overline{\mathbf{D}}}
\newcommand{\X}{\mathbf{X}}
\newcommand{\Y}{\mathbf{Y}}$

\newcommand{\Xbar}{\widehat{\mathbf{X}}}
\newcommand{\Ybar}{\widehat{\mathbf{Y}}}
\newcommand{\zz}{\mathbf{z}}
\renewcommand{\a}{\mathbf{a}}
\renewcommand{\aa}{\mathbf{a}}
\newcommand{\bb}{\mathbf{b}}
\newcommand{\cc}{\mathbf{c}}
\newcommand{\ee}{\mathbf{e}}
\newcommand{\hh}{\mathbf{h}}
\newcommand{\m}{\mathbf{m}}
\newcommand{\0}{\mathbf{0}}
\newcommand{\ve}[1]{\mathbf{#1}}
\newcommand{\col}[1]{\ifmmode\begin{bmatrix}#1\end{bmatrix}\else 
$\begin{bmatrix}#1\end{bmatrix}$\fi}
\newcommand{\scol}[1]{\left[\begin{smallmatrix}#1\end{smallmatrix}\right]}
\newcommand{\rref}{\operatorname{rref}}
\newcommand{\hide}[1]{{}}
\newcommand{\proj}{\operatorname{\mathbf{Proj}}}
\newcommand{\Span}{\operatorname{span}}
\newcommand{\pd}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\pdt}[2]{\tfrac{\partial #1}{\partial #2}}
\newcommand{\pdd}[2]{\dfrac{\partial #1}{\partial #2}}

\newcommand{\svdots}{\raisebox{3pt}{$\scalebox{.75}{\vdots}$}}
\newcommand{\sddots}{\raisebox{3pt}{$\scalebox{.75}{$\ddots$}$}}


\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\Char}{char}
\DeclareMathOperator{\Cl}{Cl}
\DeclareMathOperator{\codim}{codim}
\DeclareMathOperator{\coker}{coker}
\DeclareMathOperator{\disc}{disc}
\DeclareMathOperator{\dist}{dist}
\DeclareMathOperator{\Div}{Div}
\DeclareMathOperator{\End}{End}
\DeclareMathOperator{\Eth}{Eth}
\DeclareMathOperator{\Frac}{Frac}
\DeclareMathOperator{\Free}{Free}
%\DeclareMathOperator{\frob}{frob}
%\DeclareMathOperator{\Gal}{Gal}
%\DeclareMathOperator{\genus}{genus}
%\DeclareMathOperator{\Hecke}{Hecke}
\DeclareMathOperator{\Hom}{Hom}
%\DeclareMathOperator{\id}{id}
%\DeclareMathOperator{\im}{im}
\DeclareMathOperator{\lcm}{lcm}
\DeclareMathOperator{\Mat}{Mat}
\DeclareMathOperator{\modulo}{\medspace mod}
\DeclareMathOperator{\Norm}{N}
%\DeclareMathOperator{\nullity}{nullity}
\DeclareMathOperator{\ord}{ord}
\DeclareMathOperator{\Pic}{Pic}
%\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\red}{red}
\DeclareMathOperator{\res}{res}
\DeclareMathOperator{\sgn}{sgn}
%\DeclareMathOperator{\Span}{span}
\DeclareMathOperator{\Spec}{Spec}
\DeclareMathOperator{\Split}{Split}
\DeclareMathOperator{\Sturm}{Sturm}
\DeclareMathOperator{\Supp}{Supp}
\DeclareMathOperator{\Tate}{Tate}
\DeclareMathOperator{\tors}{tors}
%\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\val}{val}
\DeclareMathOperator{\Weil}{Weil}

\DeclareMathOperator{\sech}{sech}

\newcommand{\adjacent}{\leftrightarrow}

\DeclareMathOperator{\GL}{GL}
\DeclareMathOperator{\SL}{SL}
\DeclareMathOperator{\PGL}{PGL}
\DeclareMathOperator{\PSL}{PSL}
\DeclareMathOperator{\SO}{SO}

\newcommand{\cm}{\text{,}}
%\newcommand{\pd}{\text{.}}
\newcommand{\n}{\noindent}

\newcommand{\Omicron}{\mathrm{O}}
\newcommand{\Zeta}{\mathrm{Z}}

\renewcommand{\div}{\mathop{\mathrm{div}}}
\renewcommand{\Im}{\mathop{\mathrm{Im}}}
\renewcommand{\Re}{\mathop{\mathrm{Re}}}
\renewcommand{\ss}{\mathop{\mathrm{ss}}}
\newcommand{\elliptic}{\mathop{\mathrm{ell}}}

\newcommand{\new}{\mathop{\mathrm{new}}}
\newcommand{\old}{\mathop{\mathrm{old}}}

\newcommand{\Bs}{\boldsymbol}
%\newcommand{\ds}{\displaystyle}
%\newcommand{\f}{\mathfrak}
\newcommand{\s}{\mathcal}

%\newcommand{\A}{\mathbb{A}}
%\newcommand{\C}{\mathbb{C}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\Fpbar}{\bar{\mathbb{\F}}_p}
\newcommand{\G}{\mathbb{G}}
\newcommand{\Gm}{\mathbb{G}_{\mathrm{m}}}
\newcommand{\N}{\mathbb{N}}
\renewcommand{\P}{\mathbb{P}}
\newcommand{\Q}{\mathbb{Q}}
%\newcommand{\R}{\mathbb{R}}
%\newcommand{\R}{\mathbf{R}}
\newcommand{\T}{\mathbb{T}}
\newcommand{\V}{\mathcal{V}}
\newcommand{\Z}{\mathbb{Z}}

\newcommand{\E}{\mathbf{E}}
\renewcommand{\H}{\mathrm{H}}
\newcommand{\M}{\mathbf{M}}
\renewcommand{\S}{\mathbf{S}}

\newcommand{\var}{\mathbf{Var}}
\newcommand{\eps}{\varepsilon}

\newcommand{\erf}{\operatorname{erf}}

\newcommand{\rar}{\rightarrow}
\newcommand{\lar}{\leftarrow}
\newcommand{\hrar}{\hookrightarrow}
\renewcommand{\iff}{\Longleftrightarrow}
\newcommand{\xrar}{\xrightarrow}
\newcommand{\rrar}{\longrightarrow}
\newcommand{\mt}{\mapsto}
\newcommand{\mmt}{\longmapsto}

\newcommand{\angles}[1]{\langle #1\rangle}
\newcommand{\ceiling}[1]{\lceil #1\rceil}
\newcommand{\floor}[1]{\lfloor #1\rfloor}

\newcommand{\set}[2]{\{\,#1\,\,|\,\,#2\,\}}

\renewcommand{\emph}{\it}
\renewcommand{\em}{\emph}

$\newcommand{\pd}[2]{\frac{\partial #1}{\partial #2}}$

</p>
<article>
    <h1>Chapter 15</h1>  

<div>
<h3>Visualizing Hamiltonian dynamics and gradient descent dynamics.</h3>
</div>

<h4 id="gradientDescent">Gradient descent dynamics.</h4>


<p> Recall for a function $E: \mathbf{R}^n \to \mathbf{R}$, gradient descent dynamics for $E$ is the first-order autonomous ODE system
$$\mathbf{x}'(t) = -(\nabla E)(\mathbf{x}(t)).$$</p>


<p> Below we give two examples of gradient descent dynamics with differrent $E$. Gradient vector fields, level sets of $E$, and stationary points are shown. Drag the blue dot to your desried position to generate a trajectory starting from that position. Observe that the trajectories are always orthogonal to the level sets. Notice that the gradient vectors fields and the trajectories are going in opposite directions. </p>

     

<div class="twoCol_5050">
  
  <div>
    <div>
        <fieldset >
        <legend class="controlLegend">Gradient Descent Dynamics: Example 1</legend>
        <p>$E(x,y) = (1/6)(x^3-3x) + (1/2)y^2$.</p>
        <div style="width:100%; padding-top:100%; position:relative">
        <div id = "gd_ex_box_1" class="jxgbox"  style="position:absolute;top: 0;width:100%;height:100%">
          </div>
          </div>
        </fieldset>
    </div> 
</div> 

    <div>
        <fieldset >
        <legend class="controlLegend">Gradient Descent Dynamics: Example 2</legend>
        <p>$E(x,y)=-1/2x^2 + y^2$.</p>
        <div style="width:100%; padding-top:100%; position:relative">
        <div id = "gd_ex_box_2" class="jxgbox"  style="position:absolute;top: 0;width:100%;height:100%">
          </div>
          </div>
        </fieldset>
    </div>
</div>  




<br>
<h4 id="fromHamiltonian">Gradient descent from Hamiltonian dynamics.</h4>

<p> As discussed in this chapter, gradient descent dynamics can be viewed as a limiting form  of Hamiltonian dynamics when 
a strong damping is inserted.  For a function $E:\mathbf{R}^{2n} \to \mathbf{R}$ defined by $E(\mathbf{x}, \mathbf{y}) = \frac{1}{2}|\!|\mathbf{y}|\!|^2 + V(\mathbf{x})$ 
for $\mathbf{x}, \mathbf{y} \in \mathbf{R}^n$ with $V(\mathbf{x})$ some
function, the associated Hamiltonian system is
\[
\left\{
\begin{array}{l}
  \x'(t) = \y(t),\\
  \y'(t) = -\nabla V(\x(t)).
\end{array}
\right.
\]

 </p>

<p> As in our experience with the first-order damped
pendulum ODE system, a "damping" can be introduced by adding
 an extra term $-\gamma\, \y(t)$ for a constant $\gamma>0$ to get the modified ODE system
\begin{equation}\label{dampedH}
\left\{
\begin{array}{l}
  \x'(t) = \y(t)\\
  \y'(t) = -\gamma\, \y(t) -(\nabla V)(\x(t)).
\end{array}
\right.
\end{equation}
If $\gamma$ is large then eventually $\y(t)$ becomes fairly constant and the remaining dynamics in $\x(t)$
is approximately gradient descent dynamics for $V$ as the energy function after scaling the time variable by $\gamma$. That is, 
\begin{equation}
\x'(t) \approx -\frac{1}{\gamma} (\nabla V)(\x(t)),
\end{equation}
so if we scale time by $\gamma$ by defining $u = t/\gamma$ and $\mathbf{X}(u) = \x(\gamma u)$ then we have
$$ \frac{d \mathbf{X}}{du} = \gamma \,\x'(\gamma u) \approx -(\nabla V)(\mathbf{X}(u)).$$
So $\mathbf{X}$ approximately satisfies gradient descent dynamics with energy $V:\R^n \to \R$!
This is the sense in which gradient descent dynamics is related to Hamiltonian dynamics.
</p>

<p> As an example, consider $E(x,y) = (1/2) y^2 +  V(x)$ where $V(x) = (1/2) x^2$ (so $V'(x) = x$); this is the dimensionless form of 
 energy for an undamped spring-mass system. In this case, the associated Hamiltonian system is
\[
\left\{
\begin{array}{l}
  x'(t) = y(t)\\
  y'(t) = -x(t),
\end{array}
\right.
\]
which is the first-order system associated to the second-order ODE $x''(t) + x(t) = 0$. 
(The solutions are given explicitly by
$x(t) = x(0) \cos t + y(0) \sin t$ and $y(t) = -x(0) \sin t + y(0) \cos t,$ but this will not be relevant below.) 

We now introduce damping by adding an extra $-\gamma\, y(t)$ term with $\gamma > 0$: 
\[
\left\{
\begin{array}{l}
  x'(t) = y(t)\\
  y'(t) = -x(t) -\gamma y(t).
\end{array}
\right.
\]
(This is the first-order system associated to the second-order ODE $x''(t) + \gamma x'(t) + x(t) = 0$, which is 
the ODE for a spring-mass system with damping coefficient $\gamma > 0$.) 
In matrix form, this is $$\x'(t) = A \x(t),\,\,\, \mbox{ for }\,\,\,
A = \begin{bmatrix} 0 & 1 \\ -1 & -\gamma\end{bmatrix}.$$</p>

<p> The "largeness" condition on $\gamma$ will require at least that $\gamma > 2$, 
so the characteristic polynomial $\lambda^2 + \gamma \lambda +1$ of the ODE system has
two distinct real roots:
\begin{equation}\label{rootformula}
\lambda_{\pm} = \frac{-\gamma \pm \sqrt{\gamma^2 -4}}{2}.
\end{equation} </p>
<p> The solutions to the ODE system are linear combinations 
\begin{equation}\label{xce}
x(t) = c_+ e^{\lambda_+ t} + c_{-} e^{\lambda_{-} t}.
\end{equation} </p>
<p> Expressing this solution in terms of the initial values $x(0)$ and $y(0)$ yields
$$c_{+} = \frac{\lambda_{-}x(0) - y(0)}{\lambda_{-} - \lambda_{+}},\,\,\,\,
c_{-} = \frac{-\lambda_{+} x(0) + y(0)}{\lambda_{-} - \lambda_{+}},$$
which gives 
\begin{equation}\label{eq:15.Hamiltonian.to.gradient.exact}
x(t) = \frac{\lambda_- x(0) - y(0)}{\lambda_- - \lambda_+} e^{\lambda_+ t} + \frac{-\lambda_+ x(0) + y(0)}{\lambda_- -\lambda_+} e^{\lambda_- t}.
\end{equation}</p>


<p> For large $\gamma$, we have 
\begin{equation}
\x'(t) \approx -\frac{1}{\gamma} (\nabla V)(\x(t)) = -\frac{1}{\gamma}\begin{bmatrix} x \\ 0\end{bmatrix},
\end{equation}
$$\lambda_- \approx -\gamma,\,\,\,  \lambda_{+} \approx -\frac{1}{\gamma},$$
and 
$$x(t) \approx \frac{\lambda_- x(0) - y(0)}{\lambda_{-} - \lambda_+} e^{\lambda_+ t} \approx \frac{-\gamma x(0)- y(0)}{-\gamma + 1/\gamma} 
e^{-(1/\gamma) t} \approx x(0) e^{-(1/\gamma) t}.$$
</p>

<p> In the graph below we visualize this first-order system. To play with the visulization yourself, change the adamping coefficient, choose your desired display options, choose your desired initial condition by dragging the blue point on the graph, and see how the trajectory and the graph of $x(t)$ and its approximation change. The stationary point is shown as red dot. The two eigenlines are also shown. </p>



   

<div class="twoCol_5050">
  <div>
  <div class="twoCol_5050">
  <div> 
  <fieldset>
      <legend class="controlLegend">Damping Coefficient</legend>
 <div class="range-wrap" style="width: 92%;">
  <label for="gamma_damp">$\gamma$: </label>
  <input id = "gamma_damp" type="range" class="range" min="3" max="15" step = 1 value = "10" oninput="new_graph()">
  <output class="bubble"></output><br>
 </div>
</fieldset>
 </div> 
 <div>
<fieldset>
  <legend class="controlLegend">Display Options</legend>
      <label for="density_2">Density: </label><br>
   <input id = "density_2" type="range" class="range" min="1" max="2.8" step = 0.2 value = "1.6" style="width: 92%;" oninput="new_graph()"> <br><br>
   <input type="checkbox" id="colorize_2" checked oninput="new_graph()">
   <label for="colorize_2"> Colorize according to magnitude</label><br> 
</fieldset>
</div>
</div>
<br>
<div>
  <fieldset >
      <legend class="controlLegend">Graph of $x(t)$ and its Approximation</legend>
        <div id="approxdiv" style="width:100%; padding-top:75%; position:relative" >
        <div  id="approxPlot" style="position:absolute;top: 0;width:100%;height:100%">
          </div>
          </div>
        </fieldset>
    </div>
</div>
    <div>
        <fieldset >
        <legend class="controlLegend">Trajectory</legend>
        <div>
         <div style="width:100%; padding-top:100%; position:relative">
        <div  id = "gdbox" class="jxgbox" style="position:absolute;top: 0;width:100%;height:100%">
          </div>
          </div>
        </div>
        </fieldset>
    </div>
</div>  







<script src="js/gradient_descent_ex.js"> </script> 







<script src="js/gradient_descent_from_Hamiltonian.js"> </script> 


<script src="js/draw_bubble.js"></script>

</article>
</body>

</html>